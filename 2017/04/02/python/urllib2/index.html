<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="www.lizs.cc"><meta name="keywords" content="lizs, www.lizs.cc, lizs.cc"><title>Python - urllib2/urllib.request - lizs</title><!-- link(rel="stylesheet", type="text/css", href="//fonts.neworld.org/css?family=Source+Code+Pro")--><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><!-- #header--><div id="layout" class="layout-g"><div class="layout-r"><div id="sidebar"><div class="site-name"><h1 class="title"><a href="/." class="home">lizs</a></h1><!-- h1.hidden= current_title--><!-- a#logo(href=url_for('.'))= config.title--><p class="description">www.lizs.cc</p></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="www.lizs.cc"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="time">{date}</div><div class="title">{title}</div><!-- .tags {tags}--></a></div></template></div></div><!-- .search-pla--><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#urllib2-urllib-request"><span class="toc-text">urllib2/urllib.request</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#urllib-request-Request-url-data-None-headers-origin-req-host-None-unverifiable-False-method-None"><span class="toc-text">urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllib-request-urlopen-url-data-None-timeout-socket-GLOBAL-DEFAULT-TIMEOUT-cafile-None-capath-None-cadefault-False-context-None"><span class="toc-text">urllib.request.urlopen(url, data=None, timeout=socket._GLOBAL_DEFAULT_TIMEOUT, cafile=None, capath=None, cadefault=False, context=None)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Handler-类"><span class="toc-text">Handler 类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllib-request-build-opener-handlers"><span class="toc-text">urllib.request.build_opener(*handlers)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllib-request-install-opener-opener"><span class="toc-text">urllib.request.install_opener(opener)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义-Handler-处理-HTTPError"><span class="toc-text">自定义 Handler 处理 HTTPError</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Basic-Authorization"><span class="toc-text">HTTP Basic Authorization</span></a></li></ol></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 近期文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/12/01/others/jetbrains_activate/">JetBrains 系列产品激活</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/01/python/abstract_base_classes/">Python - Abstract Base Classes</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/05/linux/centos6.6_upgrade_python2.6/">CentOS6.6 upgrade Python2.6 to Python2.7</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/05/linux/centos6.6_deploy_php_mysql_nginx/">CentOS6.6 install PHP, MySQL and Nginx</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/05/linux/cmd_netstat/">Linux command - netstat</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/03/python/http_server/">Python - HTTP Server</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cordova/">Cordova</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Others/">Others</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP/IP</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/cmd/" style="font-size: 15px;">cmd</a> <a href="/tags/cordova/" style="font-size: 15px;">cordova</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/tutorial/" style="font-size: 15px;">tutorial</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/others/" style="font-size: 15px;">others</a> <a href="/tags/tcp-ip/" style="font-size: 15px;">tcp/ip</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/django/" style="font-size: 15px;">django</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li></ul></div><div id="nav-menu"></div></div></div><div class="layout-l"><div class="content_container"><div class="post"><div class="header"><h1 class="post-title">Python - urllib2/urllib.request</h1><div class="post-meta"><p><span class="date">2017-04-02</span><span><a href="/categories/Python/" class="category">Python</a></span><span class="view_count"><i id="busuanzi_container_page_pv"><!-- i=  __('hits') + '数: '--><i id="busuanzi_value_page_pv"></i></i></span></p></div></div><div class="post-content"><h1 id="urllib2-urllib-request"><a href="#urllib2-urllib-request" class="headerlink" title="urllib2/urllib.request"></a>urllib2/urllib.request</h1><blockquote>
<p>Python2.7: urllib2  <br><br>Python3: urllib.request</p>
</blockquote>
<h2 id="urllib-request-Request-url-data-None-headers-origin-req-host-None-unverifiable-False-method-None"><a href="#urllib-request-Request-url-data-None-headers-origin-req-host-None-unverifiable-False-method-None" class="headerlink" title="urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)"></a>urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</h2><p>构造一个请求对象.</p>
<ul>
<li><p><code>url</code>: 请求的有效URL.</p>
</li>
<li><p><code>data</code>: 请求的附加数据.</p>
<ul>
<li>Python3.3 之前, 请求的方法根据 <code>data</code> 判断.<code>&#39;GET&#39; if data is None else &#39;POST&#39;</code></li>
<li><code>data</code> 的类型要对应 <code>headers</code> 中的 <code>Content-Type</code> 属性. 如果 <code>data</code> 不为空, 而且 <code>headers</code> 中又没有指定 <code>Content-Type</code>, 则默认为 <code>application/x-www-form-urlencoded</code>. 所以, 一般 HTTP POST 请求的数据要用 <code>urllib.parse.urlencode()</code> (python2 <code>urllib.urlencode()</code>) 来转换为 <code>application/x-www-form-urlencoded</code> 格式.</li>
</ul>
</li>
<li><p><code>headers</code>: 请求的头部. 如 <code>{&#39;Accept&#39;: &#39;text/html&#39;, &#39;Content-Type&#39;: &#39;multipart/form-data&#39;}</code></p>
</li>
<li><p><code>origin_req_host</code></p>
</li>
<li><p><code>unverifiable</code></p>
</li>
<li><p><code>method</code>: <strong>New in Python3.3</strong>, 请求的方法,如: <code>HEAD</code>, <code>GET</code>, <code>POST</code>. 在 Python3.3 之前,请求的方法由 <code>data</code> 决定 <code>&#39;GET&#39; if data is None else &#39;POST&#39;</code>.</p>
</li>
</ul>
<h2 id="urllib-request-urlopen-url-data-None-timeout-socket-GLOBAL-DEFAULT-TIMEOUT-cafile-None-capath-None-cadefault-False-context-None"><a href="#urllib-request-urlopen-url-data-None-timeout-socket-GLOBAL-DEFAULT-TIMEOUT-cafile-None-capath-None-cadefault-False-context-None" class="headerlink" title="urllib.request.urlopen(url, data=None, timeout=socket._GLOBAL_DEFAULT_TIMEOUT, cafile=None, capath=None, cadefault=False, context=None)"></a>urllib.request.urlopen(url, data=None, timeout=socket._GLOBAL_DEFAULT_TIMEOUT, cafile=None, capath=None, cadefault=False, context=None)</h2><p>Open the URL <code>url</code>, which can be either a string or a <code>Request</code> object.</p>
<ul>
<li><code>url</code>: 请求的 URL,或构造好的请求对象 <code>urllib.request.Request()</code>.</li>
<li><code>data</code>: 请求的附加数据,同 <code>urllib.request.Request()</code> 的 <code>data</code> 参数.</li>
<li><code>timeout</code>: 请求的超时时间, 默认为 socket 的默认超时时间 <code>_GLOBAL_DEFAULT_TIMEOUT</code>.</li>
<li><code>cafile</code>, <code>capath</code>: HTTPS 请求的 CA 证书. 主要作为参数传给 <code>ssl.create_default_context()</code></li>
<li><code>context</code>: ssl.SSLContext 实例</li>
</ul>
<p>正常返回一个 HTTP 请求, 返回对象有以下方法:</p>
<ul>
<li><code>getcode()</code>: HTTP 的响应状态码.</li>
<li><code>geturl()</code>: 当前返回内容的 URL,可以用来判断是否重定向.</li>
<li><code>info()</code>: HTTP 的响应头部信息.<ul>
<li><code>dict</code>: 头部信息字典</li>
<li><code>get(name)</code>: 获取头部信息中名为 <code>name</code> 的值, 相当于 <code>dict.get(name)</code></li>
<li><code>getheader(name)</code>: 同 <code>get(name)</code></li>
</ul>
</li>
</ul>
<p>返回的body内容可以通过<code>read()</code>读取.</p>
<p>简单例子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from urllib.request import Request, urlopen</span><br><span class="line"></span><br><span class="line">request = Request(&apos;http://www.lizs.cc&apos;)</span><br><span class="line">response = urlopen(Request, timeout=3)</span><br></pre></td></tr></table></figure></p>
<p>注意, <code>urlopen()</code> 请求的返回对象如果不是 2xx 是会报错的. 如果想知道响应是否为 404 怎么办? 可以通过捕获 <code>HTTP.Error</code> 错误来获取.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from urllib.request import Request, urlopen, HTTPError</span><br><span class="line"></span><br><span class="line">request = Request(&apos;http://www.lizs.cc&apos;)</span><br><span class="line">try:</span><br><span class="line">    response = urlopen(Request, timeout=3)</span><br><span class="line">except HTTPError, err_response:</span><br><span class="line">    response = err_response</span><br><span class="line">print(response.getcode())  # 响应状态码</span><br><span class="line">print(response.info())  # 响应的头部</span><br><span class="line">print(response.read())  # 响应的内容(主体)</span><br></pre></td></tr></table></figure></p>
<h2 id="Handler-类"><a href="#Handler-类" class="headerlink" title="Handler 类"></a>Handler 类</h2><p>模块处理器类，用来创建 opener。</p>
<h2 id="urllib-request-build-opener-handlers"><a href="#urllib-request-build-opener-handlers" class="headerlink" title="urllib.request.build_opener(*handlers)"></a>urllib.request.build_opener(*handlers)</h2><p>创建 opener 对象.</p>
<p>-<code>*handlers</code>, 创建 opener 所需的Handler. 如: <code>build_opener(handler)</code>, <code>build_opener(handler1, handler2)</code>, <code>build_opener(*[handler1, handler2])</code></p>
<ul>
<li><p>创建 opener 的时候会自动加载以下默认 Handler: <code>ProxyHandler</code>, <code>UnknownHandler</code>, <code>HTTPHandler</code>, <code>HTTPDefaultErrorHandler</code>, <code>HTTPRedirectHandler</code>, <code>FTPHandler</code>, <code>FileHandler</code>, <code>HTTPErrorProcessor</code>.</p>
</li>
<li><p>如果提供的 <code>*handler</code> 中, 有默认Handler的子类(<code>issubclass</code>), 创建 opener 的时候将去掉相应的默认 Handler.</p>
</li>
</ul>
<h2 id="urllib-request-install-opener-opener"><a href="#urllib-request-install-opener-opener" class="headerlink" title="urllib.request.install_opener(opener)"></a>urllib.request.install_opener(opener)</h2><p>将 <code>opener</code> 设置为默认 opener.</p>
<p><strong>模块的一般使用步骤:</strong></p>
<ul>
<li>确定 Handler。</li>
<li>创建、安装 opener。</li>
<li>使用 <code>urlopen()</code> 完成请求。</li>
</ul>
<p>不创建 opener 直接 <code>urlopen()</code> 会使用默认的 opener (使用默认 Handler)。</p>
<h3 id="自定义-Handler-处理-HTTPError"><a href="#自定义-Handler-处理-HTTPError" class="headerlink" title="自定义 Handler 处理 HTTPError"></a>自定义 Handler 处理 HTTPError</h3><p>模块默认 Handler 对 HTTP 响应状态码不是 <code>200 &lt;= code &lt; 300</code>的，都 raise <code>HTTPError</code> 来处理的，有时候很不方便，我们可以自定义一个Handler来处理 HTTPError。</p>
<p>默认 Handler 中，<code>HTTPDefaultErrorHandler</code> 会 raise 所有 HTTPError。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class HTTPDefaultErrorHandler(BaseHandler):</span><br><span class="line">    def http_error_default(self, req, fp, code, msg, hdrs):</span><br><span class="line">        raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)</span><br></pre></td></tr></table></figure></p>
<p>重新定义处理 Handler：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class MyHTTPErrorHandler(urllib.request.HTTPDefaultErrorHandler):</span><br><span class="line">    def http_error_default(self, req, fp, code, msg, hdrs):</span><br><span class="line">        return urllib.request.HTTPError(req.get_full_url(), code, msg, hdrs, fp)</span><br></pre></td></tr></table></figure></p>
<p>使用自定义的 Handler 来 <code>urlopen</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">opener = urllib.request.build_opener(MyHTTPErrorHandler)</span><br><span class="line">urllib.request.install_opener(opener)</span><br><span class="line">request = urllib.request.Request(&apos;http://www.lizs.cc&apos;)</span><br><span class="line">response = urllib.request.urlopen(request, timeout=3)</span><br></pre></td></tr></table></figure></p>
<p>因为，<code>issubclass(MyHTTPErrorHandler, HTTPDefaultErrorHandler) == True</code>，所以，<code>HTTPDefaultErrorHandler</code> 被去掉。</p>
<p>也可以通过定义 <code>HTTPErrorProcessor</code> 的子类来处理。因为，<code>HTTPErrorProcessor</code> 规定了响应状态码不为 <code>200 &lt;= code &lt; 300</code> 都是 HTTPError。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class HTTPErrorProcessor(BaseHandler):</span><br><span class="line">    &quot;&quot;&quot;Process HTTP error responses.&quot;&quot;&quot;</span><br><span class="line">    handler_order = 1000  # after all other processing</span><br><span class="line"></span><br><span class="line">    def http_response(self, request, response):</span><br><span class="line">        code, msg, hdrs = response.code, response.msg, response.info()</span><br><span class="line"></span><br><span class="line">        # According to RFC 2616, &quot;2xx&quot; code indicates that the client&apos;s</span><br><span class="line">        # request was successfully received, understood, and accepted.</span><br><span class="line">        if not (200 &lt;= code &lt; 300):</span><br><span class="line">            response = self.parent.error(</span><br><span class="line">                &apos;http&apos;, request, response, code, msg, hdrs)</span><br><span class="line"></span><br><span class="line">        return response</span><br><span class="line"></span><br><span class="line">    https_response = http_response</span><br></pre></td></tr></table></figure></p>
<p>定义 Handler 将 404 响应状态码归类到正常状态。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MyHTTPErrorProcessor(urllib.request.HTTPErrorProcessor):</span><br><span class="line"></span><br><span class="line">    def http_response(self, request, response):</span><br><span class="line">        code, msg, hdrs = response.code, response.msg, response.info()</span><br><span class="line"></span><br><span class="line">        # According to RFC 2616, &quot;2xx&quot; code indicates that the client&apos;s</span><br><span class="line">        # request was successfully received, understood, and accepted.</span><br><span class="line">        if not (200 &lt;= code &lt; 300 or code == 404):</span><br><span class="line">            response = self.parent.error(</span><br><span class="line">                &apos;http&apos;, request, response, code, msg, hdrs)</span><br><span class="line"></span><br><span class="line">        return response</span><br></pre></td></tr></table></figure></p>
<p>当 HTTP 响应状态码为 <code>200 &lt;= code &lt; 300 or code == 404</code> 都不会 raise HTTPError.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">opener = urllib.request.build_opener(MyHTTPErrorProcessor)</span><br><span class="line">urllib.request.install_opener(opener)</span><br><span class="line">request = urllib.request.Request(&apos;http://www.lizs.cc/404&apos;)</span><br><span class="line">response = urllib.request.urlopen(request)</span><br></pre></td></tr></table></figure></p>
<h3 id="HTTP-Basic-Authorization"><a href="#HTTP-Basic-Authorization" class="headerlink" title="HTTP Basic Authorization"></a>HTTP Basic Authorization</h3><p>模块提供了 <code>HTTPBasicAuthHandler(password_mgr=None)</code> 来处理 HTTP Basic 认证。</p>
<ul>
<li><code>password_mgr</code>: 密码管理器，可以用 <code>HTTPPasswordMgrWithDefaultRealm</code>。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">uri = &apos;http://www.lizs.cc&apos;  # 需要 Basic 认证的url</span><br><span class="line">user = &apos;admin&apos;  # Basic 认证的用户名</span><br><span class="line">passwd = &apos;123456&apos;  # Basic 认证的密码</span><br><span class="line">mgr = urllib.request.HTTPPasswordMgrWithDefaultRealm()</span><br><span class="line">mgr.add_password(None, uri, user, passwd)</span><br><span class="line">handler = urllib.request.HTTPBasicAuthHandler(password_mgr=mgr)</span><br><span class="line">opener = urllib.request.build_opener(handler)</span><br><span class="line">urllib.request.install_opener(opener)</span><br><span class="line">request = urllib.request.Request(uri)</span><br><span class="line">response = urllib.request.urlopen(request)</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/python/">python</a></div><div class="post-nav"><a href="/2017/04/23/linux/service/" class="pre">Linux service</a><a href="/2017/03/25/linux/ubuntu_install_rpm_packages/" class="next">Ubuntu install rpm packages</a></div></div><!-- include _partial/footer--></div></div></div><a id="totop" href="#top"></a></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script></body></html>